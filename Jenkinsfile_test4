pipeline {
  agent any
  triggers{
	pollSCM('*/5 * * * *')
  }
  stages{
       stage ('Build'){
        steps {
          sh 'mvn clean package'
        }
		post {
			success {
			echo 'Archiving...'
			archiveArtifacts artifacts:'**/target/*.war'
			}
		  }
		}
		stage ('Deployments'){
        parallel{
			stage ('Deploy to stage'){
				steps {
					build job:'deploy_to_staging'
          }
		}
			stage ('Deploy to prod'){
				steps {
					timeout(time:5, until:'DAYS'){
					input message:'Approve Prod deployment?'
				}
				build job:'deploy_to_prod'
				}
			}
          }
		}
	}
}
		
         
  
